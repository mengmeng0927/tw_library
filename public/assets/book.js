var App={Views:{},router:{},helper:{}};App.helper.renderTemplate=function(c,a){var b=haml.compileHaml({sourceId:c+"-template"});return b(a)};var Book=Backbone.Model.extend({url:function(){var a="books";if(this.isNew()){return a}return a+(a.charAt(a.length-1)=="/"?"":"/")+this.id}});App.Views.Index=Backbone.View.extend({tagName:"section",initialize:function(){this.books=this.options.books;this.render()},render:function(){if(this.books.length>0){var a=App.helper.renderTemplate("new",{});$(this.el).html(a)}$(this.el).html(out);$("#app").html(this.el)}});App.router.Books=Backbone.Router.extend({routes:{"":"index"},index:function(){$.getJSON("/books",function(a){if(a){var b=_(a).map(function(c){return new Book(c)});new App.Views.Index({books:b})}else{new Error({message:"Error loading books."})}})}});$(function(){new App.router.Books();Backbone.history.start()});